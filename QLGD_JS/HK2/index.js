var GhepLop=React.createClass({displayName:"GhepLop",getInitialState:function(){return{sinh_vien_id:-1,ma_lop_hanh_chinh:-1,lop_id:-1}},componentDidMount:function(){$("#lhc").select2({placeholder:"Tìm lớp hành chính",minimumInputLength:3,ajax:{url:"/daotao/lop_hanh_chinhs.json",quietMillis:100,data:function(t,e){return{q:t,page_limit:30,page:e}},results:function(t,e){var a=30*e<t.total;return{results:t.lop_hanh_chinhs,more:a}},text:function(t){return t},id:function(t){return t}}}),$("#lmh").select2({placeholder:"Tìm lớp môn học",minimumInputLength:3,ajax:{url:"/daotao/lop_mon_hocs.json",quietMillis:100,data:function(t,e){return{q:t,page_limit:30,page:e}},results:function(t,e){var a=30*e<t.total;return{results:t.lop_mon_hocs,more:a}},text:function(t){return t},id:function(t){return t}}}),$("#sv").select2({placeholder:"Tìm sinh viên",minimumInputLength:3,ajax:{url:"/daotao/sinh_viens.json",quietMillis:100,data:function(t,e){return{q:t,page_limit:30,page:e}},results:function(t,e){var a=30*e<t.total;return{results:t.sinh_viens,more:a}},text:function(t){return t},id:function(t){return t}}})},getLopHanhChinh:function(){var t=$("#lhc").val(),e=$("#lmh").val();null!=t&&null!=e?(this.setState({ma_lop_hanh_chinh:t,lop_id:e}),React.unmountAndReleaseReactRootNode(document.getElementById("kq")),React.renderComponent(LopHanhChinh({ma_lop_hanh_chinh:t,lop_id:e}),document.getElementById("kq"))):alert("Bạn phải chọn lớp hành chính, hoặc sinh viên, hoặc lớp môn học")},render:function(){return React.DOM.div(null,React.DOM.div({className:"row"},React.DOM.div({className:"col-md-5"},React.DOM.h4(null,"Chọn lớp hành chính"),React.DOM.input({type:"hidden",id:"lhc",style:{width:"70%"},className:"input-xlarge"})),React.DOM.div({className:"col-md-2"},React.DOM.br(null),React.DOM.br(null),React.DOM.button({onClick:this.getLopHanhChinh,className:"btn btn-success"},"Chọn")),React.DOM.div({className:"col-md-5"},React.DOM.h4(null,"Chọn lớp Môn học"),React.DOM.input({type:"hidden",id:"lmh",style:{width:"500px"},className:"input-xlarge"}))),React.DOM.div({className:"row",id:"kq"}))}}),LopHanhChinh=React.createClass({displayName:"LopHanhChinh",getInitialState:function(){return{data:[],checked:[]}},loadData:function(){$.ajax({url:"/daotao/lop_hanh_chinhs",type:"POST",data:{ma_lop_hanh_chinh:this.props.ma_lop_hanh_chinh},success:function(t){this.setState({data:t}),React.renderComponent(LopMonHoc({lop_id:this.props.lop_id}),document.getElementById("lop"))}.bind(this)})},componentWillMount:function(){this.loadData()},onMove:function(){var t=[];$("input[id^=svs]").each(function(e,a){a.checked===!0&&t.push(a.value)}),t.length>0&&$.ajax({url:"/daotao/move",type:"POST",data:{ma_lop_hanh_chinh:this.props.ma_lop_hanh_chinh,lop_id:this.props.lop_id,sinh_viens:t},success:function(){React.unmountAndReleaseReactRootNode(document.getElementById("lop")),React.renderComponent(LopMonHoc({lop_id:this.props.lop_id}),document.getElementById("lop"))}.bind(this)})},checkAll:function(){$("input[id^=svs]").each(function(t,e){e.checked=!e.checked})},render:function(){var t=this.state.data.map(function(t,e){return React.DOM.tr(null,React.DOM.td(null,e+1),React.DOM.td(null,t.code),React.DOM.td(null,t.hovaten),React.DOM.td(null,React.DOM.div({className:"checkbox"},React.DOM.label(null,React.DOM.input({id:"svs"+t.code,value:t.id,type:"checkbox"},"Chọn")))))});return React.DOM.div({className:"row"},React.DOM.div({className:"col-md-6 table-responsive"},React.DOM.button({onClick:this.onMove,className:"btn btn-primary"},"Chuyển"),React.DOM.hr(null),React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Stt"),React.DOM.td(null,"Mã sinh viên"),React.DOM.td(null,"Họ và tên"),React.DOM.td(null,React.DOM.div({className:"checkbox"},React.DOM.label(null,React.DOM.input({onClick:this.checkAll,type:"checkbox"},"Chọn tất cả")))))),React.DOM.tbody(null,t))),React.DOM.div({className:"col-md-6 table-responsive",id:"lop"}))}}),LopMonHoc=React.createClass({displayName:"LopMonHoc",getInitialState:function(){return{data:[]}},loadData:function(){$.ajax({url:"/daotao/lop_mon_hocs",type:"POST",data:{lop_id:this.props.lop_id},success:function(t){this.setState({data:t})}.bind(this)})},componentWillMount:function(){this.loadData()},onRemove:function(t){if(console.log(t.id+" - "+this.props.lop_id),confirm("Khi xóa sinh viên ra khỏi lớp, dữ liệu điểm danh sẽ bị xóa, bạn có chắc muốn xóa sinh viên ra khỏi lớp không?")){var t={lop_id:this.props.lop_id,enrollment_id:t.id,_method:"delete"};$.ajax({url:"/daotao/lop_mon_hocs",type:"POST",data:t,success:function(t){this.setState({data:t})}.bind(this)})}},render:function(){var t=this,e=this.state.data.map(function(e,a){return React.DOM.tr({className:e.bosung_status},React.DOM.td(null,a+1),React.DOM.td(null,e.code),React.DOM.td(null,e.name),React.DOM.td(null,e.tinchi_status),React.DOM.td(null,React.DOM.button({onClick:t.onRemove.bind(t,e),className:"btn btn-sm btn-danger"},"Xóa")))});return React.DOM.table({className:"table table-bordered table-striped"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Stt"),React.DOM.td(null,"Mã sinh viên"),React.DOM.td(null,"Họ và tên"),React.DOM.td(null,"Tín chỉ?"),React.DOM.td(null,"Xóa"))),React.DOM.tbody(null,e))}}),ldata=[{id:1,tuan:1,thoi_gian:"6h30 12/08/2013",giang_vien:"gv1",phong:"phong",so_tiet:3,alias_state:"Nghỉ dạy",type_status:"Lý thuyết",note:"om"},{id:2,tuan:1,thoi_gian:"6h30 12/08/2013",giang_vien:"gv1",phong:"phong",so_tiet:3,alias_state:"Bổ sung",type_status:"Lý thuyết",note:""}],DuyetDangKy=React.createClass({displayName:"DuyetDangKy",getInitialState:function(){return{data:[],active:-1}},loadData:function(){$.ajax({url:"/daotao/lich_trinh_giang_days",success:function(t){this.setState({data:t,active:-1}),React.renderComponent(LichDaDuyet(null),document.getElementById("lichdaduyet"))}.bind(this)})},componentWillMount:function(){this.loadData()},handleAccept:function(t){$.ajax({url:"/daotao/lich_trinh_giang_days/accept",type:"POST",data:t,success:function(t){this.setState({data:t}),React.unmountAndReleaseReactRootNode(document.getElementById("lichdaduyet")),React.renderComponent(LichDaDuyet(null),document.getElementById("lichdaduyet"))}.bind(this)})},handleDrop:function(t){$.ajax({url:"/daotao/lich_trinh_giang_days/drop",type:"POST",data:t,success:function(t){this.setState({data:t}),React.unmountAndReleaseReactRootNode(document.getElementById("lichdaduyet")),React.renderComponent(LichDaDuyet(null),document.getElementById("lichdaduyet"))}.bind(this)})},handleCheck:function(t){this.setState({active:t.id}),React.unmountAndReleaseReactRootNode(document.getElementById("lichtrung")),React.renderComponent(LichTrung({id:t.id}),document.getElementById("lichtrung"))},render:function(){var t=this,e=this.state.data.map(function(e,a){return LichDuyet({key:e.id,active:t.state.active,onCheck:t.handleCheck,onAccept:t.handleAccept,onDrop:t.handleDrop,color:a%2===0?"warning":"danger",data:e})});return React.DOM.div(null,React.DOM.div({id:"lichtrung"}),React.DOM.div({className:"table-responsive"},React.DOM.h4(null,"Danh sách lịch đăng ký"),React.DOM.table({className:"table table-bordered table-striped"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần"),React.DOM.td(null,"Thời gian"),React.DOM.td(null,"Thông tin"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Loại"),React.DOM.td(null,"Giờ học"),React.DOM.td(null,"Lí do"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,e))),React.DOM.div({id:"lichdaduyet"}))}}),LichDuyet=React.createClass({displayName:"LichDuyet",onAccept:function(){if("Bổ sung"===this.props.data.alias_state){var t=this.refs.phong.getDOMNode().value;this.props.onAccept({id:this.props.data.id,phong:t})}else this.props.onAccept(this.props.data)},onDrop:function(){this.props.onDrop(this.props.data)},onCheck:function(){this.props.onCheck(this.props.data)},componentDidMount:function(){"Bổ sung"===this.props.data.alias_state&&(this.refs.phong.getDOMNode().value=this.props.data.phong)},render:function(){return React.DOM.tr({className:this.props.active===this.props.data.id?"default":this.props.color},React.DOM.td(null,this.props.data.tuan),React.DOM.td(null,this.props.data.thoi_gian),React.DOM.td(null,this.props.data.giang_vien,React.DOM.br(null),this.props.data.ma_lop,React.DOM.br(null),this.props.data.ten_mon_hoc),React.DOM.td(null,"Bổ sung"===this.props.data.alias_state?React.DOM.input({type:"text",ref:"phong"}):this.props.data.phong),React.DOM.td(null,this.props.data.so_tiet),React.DOM.td(null,this.props.data.alias_state),React.DOM.td(null,this.props.data.type_status),React.DOM.td(null,this.props.data.note),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onDrop},"Không chấp nhận"),React.DOM.button({className:"btn btn-sm btn-primary",onClick:this.onAccept},"Chấp nhận"),React.DOM.button({style:{display:"Bổ sung"===this.props.data.alias_state?"":"none"},className:"btn btn-sm btn-warning",onClick:this.onCheck},"Kiểm tra")))}}),LichTrung=React.createClass({displayName:"LichTrung",getInitialState:function(){return{data:[],sinh_vien:[],loading:!1}},componentWillMount:function(){this.loadData()},loadData:function(){this.setState({loading:!0}),$.ajax({url:"/daotao/lich_trinh_giang_days/check",data:{id:this.props.id},type:"POST",success:function(t){this.setState({data:t.lich,sinh_vien:t.sinh_vien,loading:!1})}.bind(this)})},componentDidUpdate:function(){if(this.state.loading===!0){var t={lines:15,length:40,width:10,radius:22,corners:1,rotate:38,direction:1,color:"#000",speed:1.7,trail:81,shadow:!0,hwaccel:!0,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},e=document.getElementById("foo"),a=new Spinner(t).spin(e);$(e).data("spinner",a)}else{var e=document.getElementById("foo"),a=new Spinner(t).stop(e);$("#foo").data("spinner").stop()}},componentDidMount:function(){if(this.state.loading===!0){var t={lines:15,length:40,width:10,radius:22,corners:1,rotate:38,direction:1,color:"#000",speed:1.7,trail:81,shadow:!0,hwaccel:!0,className:"spinner",zIndex:2e9,top:"auto",left:"auto"},e=document.getElementById("foo"),a=new Spinner(t).spin(e);$(e).data("spinner",a)}else $("#foo").data("spinner").stop()},render:function(){var t=this.state.data.map(function(t,e){return React.DOM.tr({className:e%2===0?"warning":"danger"},React.DOM.td(null,t.tuan),React.DOM.td(null,t.thoi_gian),React.DOM.td(null,t.giang_vien),React.DOM.td(null,t.phong),React.DOM.td(null,t.so_tiet),React.DOM.td(null,t.alias_state),React.DOM.td(null,t.type_status))}),e=this.state.sinh_vien.map(function(t,e){return React.DOM.tr({className:e%2===0?"warning":"danger"},React.DOM.td(null,e+1),React.DOM.td(null,t.code),React.DOM.td(null,t.hovaten),React.DOM.td(null,t.ma_lop_hanh_chinh))});return React.DOM.div(null,React.DOM.div({id:"foo"}),React.DOM.div({className:"table-responsive"},React.DOM.h4(null,"Danh sách lịch trùng"),React.DOM.table({className:"table table-bordered table-striped"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần"),React.DOM.td(null,"Thời gian"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Loại"),React.DOM.td(null,"Giờ học"))),React.DOM.tbody(null,t))),React.DOM.div({className:"table-responsive"},React.DOM.h4(null,"Danh sách sinh viên trùng"),React.DOM.table({className:"table table-bordered table-striped"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Stt"),React.DOM.td(null,"Mã sinh viên"),React.DOM.td(null,"Họ và tên"),React.DOM.td(null,"Mã lớp hành chính"))),React.DOM.tbody(null,e))))}}),LichDaDuyet=React.createClass({displayName:"LichDaDuyet",getInitialState:function(){return{data:[]}},componentWillMount:function(){this.loadData()},loadData:function(){$.ajax({url:"/daotao/lich_trinh_giang_days/daduyet",success:function(t){this.setState({data:t})}.bind(this)})},render:function(){var t=this.state.data.map(function(t,e){return React.DOM.tr({className:e%2===0?"warning":"danger"},React.DOM.td(null,t.tuan),React.DOM.td(null,t.thoi_gian),React.DOM.td(null,t.giang_vien),React.DOM.td(null,t.phong),React.DOM.td(null,t.so_tiet),React.DOM.td(null,t.alias_state),React.DOM.td(null,t.type_status),React.DOM.td(null,t.alias_status),React.DOM.td(null,t.updated_alias))});return React.DOM.div({className:"table-responsive"},React.DOM.h4(null,"Danh sách lịch đã duyệt"),React.DOM.table({className:"table table-bordered table-striped"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần"),React.DOM.td(null,"Thời gian"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Loại"),React.DOM.td(null,"Giờ học"),React.DOM.td(null,"Trạng thái"),React.DOM.td(null,"Ngày duyệt"))),React.DOM.tbody(null,t)))}}),TaoLop=React.createClass({displayName:"TaoLop",getInitialState:function(){return{giang_viens:[],mon_hocs:[]}},loadData:function(){$.ajax({url:"/daotao/giang_viens",success:function(t){this.setState({giang_viens:t.giang_viens,mon_hocs:t.mon_hocs}),React.renderComponent(LopMonHoc2({giang_viens:this.state.giang_viens}),document.getElementById("lop3"))}.bind(this)})},componentWillMount:function(){this.loadData()},onCreateMon:function(){var t=this.refs.ma_mon_hoc.getDOMNode().value,e=this.refs.ten_mon_hoc.getDOMNode().value,a={ma_mon_hoc:t,ten_mon_hoc:e};$.ajax({url:"/daotao/mon_hocs/create",type:"POST",data:a,success:function(t){this.setState({giang_viens:t.giang_viens,mon_hocs:t.mon_hocs})}.bind(this)})},onCreate:function(){var t=$("#gv4").val(),e=$("#mm").val(),a=this.refs.ma_lop.getDOMNode().value,n={giang_vien_id:t,mon_hoc:e,ma_lop:a};$.ajax({url:"/daotao/lop_mon_hocs/create",type:"POST",data:n,success:function(t){null!=t.error&&alert(t.error),React.unmountAndReleaseReactRootNode(document.getElementById("lop3")),React.renderComponent(LopMonHoc2({giang_viens:this.state.giang_viens}),document.getElementById("lop3")),React.unmountAndReleaseReactRootNode(document.getElementById("gheplop")),React.renderComponent(GhepLop(null),document.getElementById("gheplop")),React.unmountAndReleaseReactRootNode(document.getElementById("calendar2")),React.renderComponent(DaotaoCalendar(null),document.getElementById("calendar2"))}.bind(this)})},componentDidUpdate:function(){var t=this;$("#gv4").select2({data:t.state.giang_viens}),$("#mm").select2({data:t.state.mon_hocs})},render:function(){return React.DOM.div(null,React.DOM.hr(null),React.DOM.h4(null,"Thêm môn học"),React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Mã môn học"),React.DOM.td(null,"Tên môn học"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,React.DOM.tr({className:"danger"},React.DOM.td(null,React.DOM.input({type:"text",ref:"ma_mon_hoc",placeholder:"Mã môn học",style:{width:"100%"}}),React.DOM.br(null)),React.DOM.td(null,React.DOM.input({type:"text",ref:"ten_mon_hoc",placeholder:"Tên môn học",style:{width:"100%"}}),React.DOM.br(null)),React.DOM.td(null,React.DOM.button({className:"btn btn-success",onClick:this.onCreateMon},"Thêm môn"))))),React.DOM.hr(null),React.DOM.h4(null,"Tạo lớp"),React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Mã lớp"),React.DOM.td(null,"Môn học"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,React.DOM.tr({className:"danger"},React.DOM.td(null,React.DOM.input({type:"text",ref:"ma_lop",placeholder:"Mã lớp",style:{width:"100%"}})),React.DOM.td(null,React.DOM.input({type:"hidden",id:"mm",placeholder:"Môn học",style:{width:"100%"}})),React.DOM.td(null,React.DOM.input({type:"hidden",id:"gv4",placeholder:"Giảng viên",style:{width:"100%"},className:"input-xlarge"})),React.DOM.td(null,React.DOM.button({className:"btn btn-success",onClick:this.onCreate},"Tạo lớp"))))),React.DOM.hr(null),React.DOM.div({id:"lop3"}))}}),LopMonHoc2=React.createClass({displayName:"LopMonHoc2",getInitialState:function(){return{data:[],t:[]}},loadData:function(){$.ajax({url:"/daotao/lops",success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},componentWillMount:function(){this.loadData()},componentDidMount:function(){var t=this;$("#mytable").dataTable({sPaginationType:"bootstrap",bAutoWidth:!1,bDestroy:!0,fnDrawCallback:function(){t.forceUpdate()}})},componentDidUpdate:function(){var t=this;$("#mytable").dataTable({sPaginationType:"bootstrap",bAutoWidth:!1,bDestroy:!0}),$("#timlop").select2({data:t.state.t})},handleStart:function(t){$.ajax({url:"/daotao/lop_mon_hocs/start",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},handleRemove:function(t){$.ajax({url:"/daotao/lop_mon_hocs/remove",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},handleRestore:function(t){$.ajax({url:"/daotao/lop_mon_hocs/restore",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},handleUpdate:function(t){$.ajax({url:"/daotao/lop_mon_hocs/update",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},onSearch:function(){var t=$("#timlop").val();React.unmountAndReleaseReactRootNode(document.getElementById("assistant")),React.renderComponent(Assistant({giang_viens:this.props.giang_viens,lop:t}),document.getElementById("assistant"))},render:function(){var t=this,e=this.state.data.map(function(e,a){return LopRow({onUpdate:t.handleUpdate,onStart:t.handleStart,onRemove:t.handleRemove,onRestore:t.handleRestore,stt:a+1,data:e})});return React.DOM.div(null,React.DOM.h4(null,"Tìm lớp"),React.DOM.input({type:"hidden",id:"timlop",placeholder:"Lớp môn học",style:{width:"500px"},className:"input-xlarge"}),React.DOM.button({className:"btn btn-success",onClick:this.onSearch},"Tìm lớp"),React.DOM.div({id:"assistant"}),React.DOM.hr(null),React.DOM.h4(null,"Danh sách các lớp trong kỳ"),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered",id:"mytable"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Stt"),React.DOM.td(null,"Mã lớp"),React.DOM.td(null,"Tên môn học"),React.DOM.td(null,"Trạng thái"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,e))))}}),LopRow=React.createClass({displayName:"LopRow",getInitialState:function(){return{edit:0}},onStart:function(){this.props.onStart(this.props.data)},onRemove:function(){this.props.onRemove(this.props.data)},onRestore:function(){this.props.onRestore(this.props.data)},onEdit:function(){this.setState({edit:1})},onCancel:function(){this.setState({edit:0})},onUpdate:function(){var t=this.refs.ma_lop.getDOMNode().value;this.props.onUpdate({id:this.props.data.id,ma_lop:t}),this.setState({edit:0})},componentDidUpdate:function(){1===this.state.edit&&(this.refs.ma_lop.getDOMNode().value=this.props.data.ma_lop)},render:function(){return 0===this.state.edit?React.DOM.tr(null,React.DOM.td(null,this.props.stt),React.DOM.td(null,this.props.data.ma_lop),React.DOM.td(null,this.props.data.ten_mon_hoc),React.DOM.td(null,this.props.data.state),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-warning",onClick:this.onEdit},"Sửa"),React.DOM.button({className:"btn btn-sm btn-success",onClick:this.onStart,style:{display:this.props.data.can_start===!0?"":"none"}},"Bắt đầu"),React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onRemove,style:{display:this.props.data.can_remove===!0?"":"none"}},"Hủy"),React.DOM.button({className:"btn btn-sm btn-default",onClick:this.onRestore,style:{display:this.props.data.can_restore===!0?"":"none"}},"Phục hồi"))):React.DOM.tr(null,React.DOM.td(null,this.props.stt),React.DOM.td(null,React.DOM.input({type:"text",ref:"ma_lop"})),React.DOM.td(null,this.props.data.ten_mon_hoc),React.DOM.td(null,this.props.data.state),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-default",onClick:this.onCancel},"Hủy"),React.DOM.button({className:"btn btn-sm btn-warning",onClick:this.onUpdate},"Cập nhật"),React.DOM.button({className:"btn btn-sm btn-success",onClick:this.onStart,style:{display:this.props.data.can_start===!0?"":"none"}},"Bắt đầu"),React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onRemove,style:{display:this.props.data.can_remove===!0?"":"none"}},"Hủy"),React.DOM.button({className:"btn btn-sm btn-default",onClick:this.onRestore,style:{display:this.props.data.can_restore===!0?"":"none"}},"Phục hồi")))}}),Assistant=React.createClass({displayName:"Assistant",getInitialState:function(){return{data:[],users:[]}},loadData:function(){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants",success:function(t){this.setState({data:t})}.bind(this)}),$.ajax({url:"/daotao/users",success:function(t){this.setState({users:t})}.bind(this)})},componentWillMount:function(){this.loadData()},componentDidUpdate:function(){var t=this;$("#ast").select2({data:t.props.giang_viens})},handleDelete:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants/delete",type:"POST",data:t,success:function(t){this.setState({data:t})}.bind(this)})},handleAdd:function(){var t=$("#ast").val();$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants/create",type:"POST",data:{giang_vien_id:t},success:function(t){this.setState({data:t})}.bind(this)})},handleUpdate:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants/update",type:"POST",data:t,success:function(t){this.setState({data:t})}.bind(this)})},render:function(){var t=this,e=this.state.data.map(function(e,a){return AssistantRow({onDelete:t.handleDelete,onUpdate:t.handleUpdate,users:t.state.users,stt:a+1,data:e})});return React.DOM.div(null,React.DOM.h4(null,"Thêm giảng viên:"),React.DOM.input({type:"hidden",id:"ast",placeholder:"Chọn giảng viên",style:{width:"500px"},className:"input-xlarge"}),React.DOM.button({className:"btn btn-success",onClick:this.handleAdd},"Thêm giảng viên"),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Stt"),React.DOM.td(null,"Sử dụng tài khoản"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Mã giảng viên"),React.DOM.td(null,"Trợ giảng?"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,e))))}}),AssistantRow=React.createClass({displayName:"AssistantRow",getInitialState:function(){return{add:0}},onEdit:function(){this.setState({add:1})},onCancel:function(){this.setState({add:0})},onUpdate:function(){var t=$("#username").select2("data").text,e=this.props.data.id,a=this.refs.trogiang.getDOMNode().checked;this.setState({add:0}),this.props.onUpdate({username:t,id:e,trogiang:a})},onDelete:function(){this.props.onDelete(this.props.data)},componentDidUpdate:function(){if(1===this.state.add){var t=this;$("#username").select2({data:t.props.users}),$("#username").select2("data",{id:this.props.data.username,text:this.props.data.username})}},render:function(){return 0===this.state.add?React.DOM.tr({className:"danger"},React.DOM.td(null,this.props.stt),React.DOM.td(null,this.props.data.username),React.DOM.td(null,this.props.data.hovaten),React.DOM.td(null,this.props.data.code),React.DOM.td(null,this.props.data.trogiang===!0?"Trợ giảng":"Giảng viên chính"),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onDelete},"Xóa"),React.DOM.button({className:"btn btn-sm btn-primary",onClick:this.onEdit},"Sửa"))):React.DOM.tr(null,React.DOM.td(null,this.props.stt),React.DOM.td(null,React.DOM.input({ref:"username",type:"hidden",id:"username",style:{width:"100%"},placeholder:"email"})),React.DOM.td(null,this.props.data.hovaten),React.DOM.td(null,this.props.data.code),React.DOM.td(null,React.DOM.div({className:"checkbox"},React.DOM.label(null,React.DOM.input({ref:"trogiang",value:this.props.trogiang,type:"checkbox"},"Trợ giảng")))),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onDelete},"Xóa"),React.DOM.button({className:"btn btn-sm btn-primary",onClick:this.onUpdate},"Cập nhật"),React.DOM.button({className:"btn btn-sm btn-warning",onClick:this.onCancel},"Hủy")))}}),DaotaoCalendar=React.createClass({displayName:"DaotaoCalendar",getInitialState:function(){return{data:[]}},loadData:function(){$.ajax({url:"/daotao/lops",success:function(t){this.setState({data:t.t})}.bind(this)})},componentWillMount:function(){this.loadData()},componentDidUpdate:function(){var t=this;$("#timlopcalendar").select2({data:t.state.data})},onSearch:function(){var t=$("#timlopcalendar").val();React.unmountAndReleaseReactRootNode(document.getElementById("cc")),React.renderComponent(CalendarComponent({lop_id:t}),document.getElementById("cc"))},render:function(){return React.DOM.div(null,React.DOM.hr(null),React.DOM.input({type:"hidden",id:"timlopcalendar",placeholder:"Lớp môn học",style:{width:"500px"},className:"input-xlarge"}),React.DOM.button({className:"btn btn-success",onClick:this.onSearch},"Tìm lớp"),React.DOM.hr(null),React.DOM.div({id:"cc"}))}}),tdata={tuans:[23,24,25,30,31,32,33],headers:[23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]},CalendarComponent=React.createClass({displayName:"CalendarComponent",getInitialState:function(){return{tuans:[],headers:[],calendars:[],giang_viens:[],phongs:[]}},loadData:function(){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars",success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},componentWillMount:function(){this.loadData()},handleDelete:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/delete",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleGenerate:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/generate",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleRestore:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/restore",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleAdd:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/add",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleDestroy:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/destroy",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},componentDidUpdate:function(){React.unmountAndReleaseReactRootNode(document.getElementById("tc")),React.renderComponent(TaoCalendar({giang_viens:this.state.giang_viens,phongs:this.state.phongs,onAdd:this.handleAdd}),document.getElementById("tc"))},render:function(){var t=this,e=this.state.headers.map(function(t){return React.DOM.td(null,t)}),a=this.state.headers.map(function(e){return t.state.tuans.indexOf(e)>=0?React.DOM.td({className:"success"},"H"):React.DOM.td(null,"_")}),n=this.state.calendars.map(function(e){return DaotaoCalendarRow({onDestroy:t.handleDestroy,onDelete:t.handleDelete,onGenerate:t.handleGenerate,onRestore:t.handleRestore,data:e})});return React.DOM.div(null,React.DOM.h4(null,"Tạo thời khóa biểu"),React.DOM.div({id:"tc"}),React.DOM.hr(null),React.DOM.h4(null,"Thời khóa biểu"),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table tabled-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần học bắt đầu"),React.DOM.td(null,"Số tuần"),React.DOM.td(null,"Thứ"),React.DOM.td(null,"Tiết bắt đầu"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Trạng thái"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,n))),React.DOM.hr(null),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table tabled-bordered"},React.DOM.thead(null,React.DOM.tr({className:"danger"},e)),React.DOM.tbody(null,React.DOM.tr(null,a)))))}}),TaoCalendar=React.createClass({displayName:"TaoCalendar",range:function(t,e){for(var a=[],n=t;e>=n;n++)a.push(n);return a},onAdd:function(){var t=this.refs.tuan_hoc_bat_dau.getDOMNode().value,e=this.refs.so_tuan.getDOMNode().value,a=this.refs.thu.getDOMNode().value,n=this.refs.tiet_bat_dau.getDOMNode().value,s=this.refs.so_tiet.getDOMNode().value,o=this.refs.phong.getDOMNode().value,l=this.refs.giang_vien.getDOMNode().value,c={tuan_hoc_bat_dau:t,so_tuan:e,thu:a,tiet_bat_dau:n,so_tiet:s,phong:o,giang_vien_id:l};this.props.onAdd(c)},render:function(){var t=this.range(23,42),e=this.range(1,20),a=this.range(1,6),n=t.map(function(t){return React.DOM.option({value:t},t)}),s=e.map(function(t){return React.DOM.option({value:t},t)}),o=a.map(function(t){return React.DOM.option({value:t},t)}),l=this.props.giang_viens.map(function(t){return React.DOM.option({value:t.id},t.text)}),c=this.props.phongs.map(function(t){return React.DOM.option({value:t.id},t.text)});return React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table tabled-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần học bắt đầu"),React.DOM.td(null,"Số tuần"),React.DOM.td(null,"Thứ"),React.DOM.td(null,"Tiết bắt đầu"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Giảng viên"))),React.DOM.tbody(null,React.DOM.tr(null,React.DOM.td(null,React.DOM.select({ref:"tuan_hoc_bat_dau",className:"form-control input-sm"},n)),React.DOM.td(null,React.DOM.select({ref:"so_tuan",className:"form-control input-sm"},s)),React.DOM.td(null,React.DOM.select({ref:"thu",className:"form-control input-sm"},React.DOM.option({value:"2"},"Thứ hai"),React.DOM.option({value:"3"},"Thứ ba"),React.DOM.option({value:"4"},"Thứ tư"),React.DOM.option({value:"5"},"Thứ năm"),React.DOM.option({value:"6"},"Thứ sáu"),React.DOM.option({value:"7"},"Thứ bảy"),React.DOM.option({value:"8"},"Chủ nhật"))),React.DOM.td(null,React.DOM.select({ref:"tiet_bat_dau",className:"form-control input-sm"},React.DOM.option({value:"1"},"1 (6h30)"),React.DOM.option({value:"2"},"2 (7h20)"),React.DOM.option({value:"3"},"3 (8h10)"),React.DOM.option({value:"4"},"4 (9h05)"),React.DOM.option({value:"5"},"5 (9h55)"),React.DOM.option({value:"6"},"6 (10h45)"),React.DOM.option({value:"7"},"7 (12h30)"),React.DOM.option({value:"8"},"8 (13h20)"),React.DOM.option({value:"9"},"9 (14h10)"),React.DOM.option({value:"10"},"10 (15h05)"),React.DOM.option({value:"11"},"11 (15h55)"),React.DOM.option({value:"12"},"12 (16h45)"),React.DOM.option({value:"13"},"13 (18h00)"),React.DOM.option({value:"14"},"14 (18h50)"),React.DOM.option({value:"15"},"15 (19h40)"),React.DOM.option({value:"16"},"16 (20h30)"))),React.DOM.td(null,React.DOM.select({ref:"so_tiet",className:"form-control input-sm"},o)),React.DOM.td(null,React.DOM.select({ref:"phong",className:"form-control input-sm"},c)),React.DOM.td(null,React.DOM.select({ref:"giang_vien",className:"form-control input-sm"},l))))),React.DOM.button({onClick:this.onAdd,className:"btn btn-sm btn-success"},"Thêm"))}}),DaotaoCalendarRow=React.createClass({displayName:"DaotaoCalendarRow",onDelete:function(){this.props.onDelete(this.props.data)},onGenerate:function(){this.props.onGenerate(this.props.data)},onRestore:function(){this.props.onRestore(this.props.data)},onDestroy:function(){this.props.onDestroy(this.props.data)},render:function(){return React.DOM.tr(null,React.DOM.td(null,this.props.data.tuan_hoc_bat_dau),React.DOM.td(null,this.props.data.so_tuan),React.DOM.td(null,this.props.data.thu),React.DOM.td(null,this.props.data.tiet_bat_dau),React.DOM.td(null,this.props.data.so_tiet),React.DOM.td(null,this.props.data.phong),React.DOM.td(null,this.props.data.giang_vien),React.DOM.td(null,this.props.data.state),React.DOM.td(null,React.DOM.button({style:{display:this.props.data.can_generate===!0?"":"none"},className:"btn btn-sm btn-primary",onClick:this.onGenerate},"Duyệt thực hiện"),React.DOM.button({style:{display:this.props.data.can_remove===!0?"":"none"},className:"btn btn-sm btn-warning",onClick:this.onDelete},"Xóa"),React.DOM.button({style:{display:this.props.data.can_restore===!0?"":"none"},className:"btn btn-sm btn-default",onClick:this.onRestore},"Phục hồi"),React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onDestroy},"Xóa vĩnh viễn")))
}}),PhongTrong=React.createClass({displayName:"PhongTrong",getInitialState:function(){return{data:[],date:""}},componentDidMount:function(){$(".input-append.date").datepicker({format:"dd/mm/yyyy",startDate:"11/8/2014",todayBtn:"linked",language:"vi",autoClose:!0,todayHighlight:!0})},handleDate:function(){var t=this.refs.thoi_gian.getDOMNode().value;$(".input-append.date").datepicker("hide"),this.setState({date:t}),$.ajax({url:"/daotao/phongtrong",type:"POST",data:{date:t},success:function(t){this.setState({data:t})}.bind(this)})},componentDidUpdate:function(){$(".input-append.date").datepicker({format:"dd/mm/yyyy",startDate:"11/8/2014",todayBtn:"linked",language:"vi",autoClose:!0,todayHighlight:!0}),this.refs.thoi_gian.getDOMNode().value=this.state.date},render:function(){var t=this.state.data.map(function(t,e){return PhongTrongItem({stt:e+1,data:t,key:t.phong})});return React.DOM.div(null,React.DOM.br(null),React.DOM.div({className:"input-append date"},React.DOM.input({ref:"thoi_gian",type:"text",className:"span2"}),React.DOM.span({className:"add-on"},React.DOM.i({className:"icon-th"})),React.DOM.button({className:"btn btn-sm btn-primary",onClick:this.handleDate},"Chọn ngày")),React.DOM.hr(null),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Phòng"),React.DOM.td(null,"Ca 1"),React.DOM.td(null,"Ca 2"),React.DOM.td(null,"Ca 3"),React.DOM.td(null,"Ca 4"))),React.DOM.tbody(null,t))))}}),PhongTrongItem=React.createClass({displayName:"PhongTrongItem",render:function(){var t=this,e=[1,2,3,4].map(function(e){var a=React.DOM.td(null);return t.props.data.data.length>0&&t.props.data.data.forEach(function(t){t.ca===e&&(a=React.DOM.td(null,React.DOM.a({href:"/lich/"+t.id},t.ten_mon_hoc),React.DOM.br(null),t.giang_vien))}),a});return React.DOM.tr({className:this.props.stt%2===0?"danger":"warning"},React.DOM.td(null,this.props.data.phong),e)}});React.renderComponent(GhepLop(null),document.getElementById("gheplop")),React.renderComponent(DuyetDangKy(null),document.getElementById("duyetdangky")),React.renderComponent(TaoLop(null),document.getElementById("lop2")),React.renderComponent(DaotaoCalendar(null),document.getElementById("calendar2")),React.renderComponent(PhongTrong(null),document.getElementById("phongtrong"));