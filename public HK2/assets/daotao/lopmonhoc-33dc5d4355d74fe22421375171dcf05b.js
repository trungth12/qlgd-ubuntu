var TaoLop=React.createClass({displayName:"TaoLop",getInitialState:function(){return{giang_viens:[],mon_hocs:[]}},loadData:function(){$.ajax({url:"/daotao/giang_viens",success:function(t){this.setState({giang_viens:t.giang_viens,mon_hocs:t.mon_hocs}),React.renderComponent(LopMonHoc2({giang_viens:this.state.giang_viens}),document.getElementById("lop3"))}.bind(this)})},componentWillMount:function(){this.loadData()},onCreateMon:function(){var t=this.refs.ma_mon_hoc.getDOMNode().value,e=this.refs.ten_mon_hoc.getDOMNode().value,a={ma_mon_hoc:t,ten_mon_hoc:e};$.ajax({url:"/daotao/mon_hocs/create",type:"POST",data:a,success:function(t){this.setState({giang_viens:t.giang_viens,mon_hocs:t.mon_hocs})}.bind(this)})},onCreate:function(){var t=$("#gv4").val(),e=$("#mm").val(),a=this.refs.ma_lop.getDOMNode().value,n={giang_vien_id:t,mon_hoc:e,ma_lop:a};$.ajax({url:"/daotao/lop_mon_hocs/create",type:"POST",data:n,success:function(t){null!=t.error&&alert(t.error),React.unmountAndReleaseReactRootNode(document.getElementById("lop3")),React.renderComponent(LopMonHoc2({giang_viens:this.state.giang_viens}),document.getElementById("lop3")),React.unmountAndReleaseReactRootNode(document.getElementById("gheplop")),React.renderComponent(GhepLop(null),document.getElementById("gheplop")),React.unmountAndReleaseReactRootNode(document.getElementById("calendar2")),React.renderComponent(DaotaoCalendar(null),document.getElementById("calendar2"))}.bind(this)})},componentDidUpdate:function(){var t=this;$("#gv4").select2({data:t.state.giang_viens}),$("#mm").select2({data:t.state.mon_hocs})},render:function(){return React.DOM.div(null,React.DOM.hr(null),React.DOM.h4(null,"Thêm môn học"),React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Mã môn học"),React.DOM.td(null,"Tên môn học"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,React.DOM.tr({className:"danger"},React.DOM.td(null,React.DOM.input({type:"text",ref:"ma_mon_hoc",placeholder:"Mã môn học",style:{width:"100%"}}),React.DOM.br(null)),React.DOM.td(null,React.DOM.input({type:"text",ref:"ten_mon_hoc",placeholder:"Tên môn học",style:{width:"100%"}}),React.DOM.br(null)),React.DOM.td(null,React.DOM.button({className:"btn btn-success",onClick:this.onCreateMon},"Thêm môn"))))),React.DOM.hr(null),React.DOM.h4(null,"Tạo lớp"),React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Mã lớp"),React.DOM.td(null,"Môn học"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,React.DOM.tr({className:"danger"},React.DOM.td(null,React.DOM.input({type:"text",ref:"ma_lop",placeholder:"Mã lớp",style:{width:"100%"}})),React.DOM.td(null,React.DOM.input({type:"hidden",id:"mm",placeholder:"Môn học",style:{width:"100%"}})),React.DOM.td(null,React.DOM.input({type:"hidden",id:"gv4",placeholder:"Giảng viên",style:{width:"100%"},className:"input-xlarge"})),React.DOM.td(null,React.DOM.button({className:"btn btn-success",onClick:this.onCreate},"Tạo lớp"))))),React.DOM.hr(null),React.DOM.div({id:"lop3"}))}}),LopMonHoc2=React.createClass({displayName:"LopMonHoc2",getInitialState:function(){return{data:[],t:[]}},loadData:function(){$.ajax({url:"/daotao/lops",success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},componentWillMount:function(){this.loadData()},componentDidMount:function(){var t=this;$("#mytable").dataTable({sPaginationType:"bootstrap",bAutoWidth:!1,bDestroy:!0,fnDrawCallback:function(){t.forceUpdate()}})},componentDidUpdate:function(){var t=this;$("#mytable").dataTable({sPaginationType:"bootstrap",bAutoWidth:!1,bDestroy:!0}),$("#timlop").select2({data:t.state.t})},handleStart:function(t){$.ajax({url:"/daotao/lop_mon_hocs/start",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},handleRemove:function(t){$.ajax({url:"/daotao/lop_mon_hocs/remove",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},handleRestore:function(t){$.ajax({url:"/daotao/lop_mon_hocs/restore",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},handleUpdate:function(t){$.ajax({url:"/daotao/lop_mon_hocs/update",type:"POST",data:t,success:function(t){this.setState({data:t.lops,t:t.t})}.bind(this)})},onSearch:function(){var t=$("#timlop").val();React.unmountAndReleaseReactRootNode(document.getElementById("assistant")),React.renderComponent(Assistant({giang_viens:this.props.giang_viens,lop:t}),document.getElementById("assistant"))},render:function(){var t=this,e=this.state.data.map(function(e,a){return LopRow({onUpdate:t.handleUpdate,onStart:t.handleStart,onRemove:t.handleRemove,onRestore:t.handleRestore,stt:a+1,data:e})});return React.DOM.div(null,React.DOM.h4(null,"Tìm lớp"),React.DOM.input({type:"hidden",id:"timlop",placeholder:"Lớp môn học",style:{width:"500px"},className:"input-xlarge"}),React.DOM.button({className:"btn btn-success",onClick:this.onSearch},"Tìm lớp"),React.DOM.div({id:"assistant"}),React.DOM.hr(null),React.DOM.h4(null,"Danh sách các lớp trong kỳ"),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered",id:"mytable"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Stt"),React.DOM.td(null,"Mã lớp"),React.DOM.td(null,"Tên môn học"),React.DOM.td(null,"Trạng thái"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,e))))}}),LopRow=React.createClass({displayName:"LopRow",getInitialState:function(){return{edit:0}},onStart:function(){this.props.onStart(this.props.data)},onRemove:function(){this.props.onRemove(this.props.data)},onRestore:function(){this.props.onRestore(this.props.data)},onEdit:function(){this.setState({edit:1})},onCancel:function(){this.setState({edit:0})},onUpdate:function(){var t=this.refs.ma_lop.getDOMNode().value;this.props.onUpdate({id:this.props.data.id,ma_lop:t}),this.setState({edit:0})},componentDidUpdate:function(){1===this.state.edit&&(this.refs.ma_lop.getDOMNode().value=this.props.data.ma_lop)},render:function(){return 0===this.state.edit?React.DOM.tr(null,React.DOM.td(null,this.props.stt),React.DOM.td(null,this.props.data.ma_lop),React.DOM.td(null,this.props.data.ten_mon_hoc),React.DOM.td(null,this.props.data.state),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-warning",onClick:this.onEdit},"Sửa"),React.DOM.button({className:"btn btn-sm btn-success",onClick:this.onStart,style:{display:this.props.data.can_start===!0?"":"none"}},"Bắt đầu"),React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onRemove,style:{display:this.props.data.can_remove===!0?"":"none"}},"Hủy"),React.DOM.button({className:"btn btn-sm btn-default",onClick:this.onRestore,style:{display:this.props.data.can_restore===!0?"":"none"}},"Phục hồi"))):React.DOM.tr(null,React.DOM.td(null,this.props.stt),React.DOM.td(null,React.DOM.input({type:"text",ref:"ma_lop"})),React.DOM.td(null,this.props.data.ten_mon_hoc),React.DOM.td(null,this.props.data.state),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-default",onClick:this.onCancel},"Hủy"),React.DOM.button({className:"btn btn-sm btn-warning",onClick:this.onUpdate},"Cập nhật"),React.DOM.button({className:"btn btn-sm btn-success",onClick:this.onStart,style:{display:this.props.data.can_start===!0?"":"none"}},"Bắt đầu"),React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onRemove,style:{display:this.props.data.can_remove===!0?"":"none"}},"Hủy"),React.DOM.button({className:"btn btn-sm btn-default",onClick:this.onRestore,style:{display:this.props.data.can_restore===!0?"":"none"}},"Phục hồi")))}}),Assistant=React.createClass({displayName:"Assistant",getInitialState:function(){return{data:[],users:[]}},loadData:function(){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants",success:function(t){this.setState({data:t})}.bind(this)}),$.ajax({url:"/daotao/users",success:function(t){this.setState({users:t})}.bind(this)})},componentWillMount:function(){this.loadData()},componentDidUpdate:function(){var t=this;$("#ast").select2({data:t.props.giang_viens})},handleDelete:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants/delete",type:"POST",data:t,success:function(t){this.setState({data:t})}.bind(this)})},handleAdd:function(){var t=$("#ast").val();$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants/create",type:"POST",data:{giang_vien_id:t},success:function(t){this.setState({data:t})}.bind(this)})},handleUpdate:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop+"/assistants/update",type:"POST",data:t,success:function(t){this.setState({data:t})}.bind(this)})},render:function(){var t=this,e=this.state.data.map(function(e,a){return AssistantRow({onDelete:t.handleDelete,onUpdate:t.handleUpdate,users:t.state.users,stt:a+1,data:e})});return React.DOM.div(null,React.DOM.h4(null,"Thêm giảng viên:"),React.DOM.input({type:"hidden",id:"ast",placeholder:"Chọn giảng viên",style:{width:"500px"},className:"input-xlarge"}),React.DOM.button({className:"btn btn-success",onClick:this.handleAdd},"Thêm giảng viên"),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Stt"),React.DOM.td(null,"Sử dụng tài khoản"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Mã giảng viên"),React.DOM.td(null,"Trợ giảng?"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,e))))}}),AssistantRow=React.createClass({displayName:"AssistantRow",getInitialState:function(){return{add:0}},onEdit:function(){this.setState({add:1})},onCancel:function(){this.setState({add:0})},onUpdate:function(){var t=$("#username").select2("data").text,e=this.props.data.id,a=this.refs.trogiang.getDOMNode().checked;this.setState({add:0}),this.props.onUpdate({username:t,id:e,trogiang:a})},onDelete:function(){this.props.onDelete(this.props.data)},componentDidUpdate:function(){if(1===this.state.add){var t=this;$("#username").select2({data:t.props.users}),$("#username").select2("data",{id:this.props.data.username,text:this.props.data.username})}},render:function(){return 0===this.state.add?React.DOM.tr({className:"danger"},React.DOM.td(null,this.props.stt),React.DOM.td(null,this.props.data.username),React.DOM.td(null,this.props.data.hovaten),React.DOM.td(null,this.props.data.code),React.DOM.td(null,this.props.data.trogiang===!0?"Trợ giảng":"Giảng viên chính"),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onDelete},"Xóa"),React.DOM.button({className:"btn btn-sm btn-primary",onClick:this.onEdit},"Sửa"))):React.DOM.tr(null,React.DOM.td(null,this.props.stt),React.DOM.td(null,React.DOM.input({ref:"username",type:"hidden",id:"username",style:{width:"100%"},placeholder:"email"})),React.DOM.td(null,this.props.data.hovaten),React.DOM.td(null,this.props.data.code),React.DOM.td(null,React.DOM.div({className:"checkbox"},React.DOM.label(null,React.DOM.input({ref:"trogiang",value:this.props.trogiang,type:"checkbox"},"Trợ giảng")))),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onDelete},"Xóa"),React.DOM.button({className:"btn btn-sm btn-primary",onClick:this.onUpdate},"Cập nhật"),React.DOM.button({className:"btn btn-sm btn-warning",onClick:this.onCancel},"Hủy")))}});