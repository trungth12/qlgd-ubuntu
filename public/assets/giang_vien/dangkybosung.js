var MDATA=[{id:1,thoi_gian:"12/08/2013",tiet_bat_dau:1,so_tiet:3,phong:"A101",thuc_hanh:!1,status:"waiting"},{id:2,thoi_gian:"19/08/2013",tiet_bat_dau:2,so_tiet:3,phong:"A103",thuc_hanh:!1,status:"accepted"},{id:3,thoi_gian:"20/08/2013",tiet_bat_dau:2,so_tiet:3,phong:"A203",thuc_hanh:!1,status:"dropped"}],Bosung=React.createClass({displayName:"Bosung",getInitialState:function(){return{data:[],add:0}},updateLich:function(){null!=ENV.lich_id&&(React.unmountAndReleaseReactRootNode(document.getElementById("main")),React.renderComponent(Lich({lich:ENV.lich_id,lop:ENV.lop_id}),document.getElementById("main")))},loadData:function(){$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/bosung",success:function(t){this.setState({data:t,add:0})}.bind(this)})},componentWillMount:function(){this.loadData()},onAdd:function(){this.setState({add:1})},onSubmitAdd:function(){if(1==this.state.add){var t=this.refs.tiet_bat_dau.getDOMNode().value,e=this.refs.thoi_gian.getDOMNode().value,a=this.refs.phong.getDOMNode().value,n=this.refs.so_tiet.getDOMNode().value,o=this.refs.ltype.getDOMNode().value,i={thoi_gian:e,tiet_bat_dau:t,phong:a,so_tiet:n,ltype:o};$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/create_bosung",type:"POST",data:i,success:function(t){this.setState({data:t,add:0}),React.unmountAndReleaseReactRootNode(document.getElementById("calendar")),React.renderComponent(Calendar({lop:this.props.lop}),document.getElementById("calendar"))}.bind(this)})}return!1},onCancelAdd:function(){this.setState({add:0})},onUpdate:function(t){t._method="put",$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/update_bosung",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),React.unmountAndReleaseReactRootNode(document.getElementById("calendar")),React.renderComponent(Calendar({lop:this.props.lop}),document.getElementById("calendar")),this.updateLich()}.bind(this)})},onRemove:function(t){t._method="delete",$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/remove_bosung",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),React.unmountAndReleaseReactRootNode(document.getElementById("calendar")),React.renderComponent(Calendar({lop:this.props.lop}),document.getElementById("calendar")),this.updateLich()}.bind(this)})},onRestore:function(t){$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/restore_bosung",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),React.unmountAndReleaseReactRootNode(document.getElementById("calendar")),React.renderComponent(Calendar({lop:this.props.lop}),document.getElementById("calendar")),this.updateLich()}.bind(this)})},componentDidUpdate:function(){1==this.state.add&&$(".input-append.date").datepicker({format:"dd/mm/yyyy",startDate:"11/8/2014",todayBtn:"linked",language:"vi",autoClose:!0,todayHighlight:!0})},render:function(){var t=this,e=this.state.data.map(function(e){return Row2({key:"row2"+e.id,onUpdate:t.onUpdate,onRemove:t.onRemove,onRestore:t.onRestore,data:e})});return 0===this.state.add?React.DOM.div(null,React.DOM.br(null),React.DOM.button({className:"btn btn-sm btn-success curl-top-left",onClick:this.onAdd},"Đăng ký bổ sung"),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.th(null,"Stt"),React.DOM.th(null,"Thời gian"),React.DOM.th(null,"Tiết bắt đầu"),React.DOM.th(null,"Số tiết"),React.DOM.th(null,"Phòng"),React.DOM.th(null,"Loại"),React.DOM.th(null,"Trạng thái")),React.DOM.tbody(null,e)))):1===this.state.add?React.DOM.div(null,React.DOM.br(null),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.th(null,"Thời gian"),React.DOM.th(null,"Tiết bắt đầu"),React.DOM.th(null,"Số tiết dạy"),React.DOM.th(null,"Phòng"),React.DOM.th(null,"Loại"),React.DOM.th(null,"Thực hiện")),React.DOM.tbody(null,React.DOM.td(null,React.DOM.div({className:"input-append date"},React.DOM.input({ref:"thoi_gian",type:"text",className:"span2"}),React.DOM.span({className:"add-on"},React.DOM.i({className:"icon-th"})))),React.DOM.td(null,React.DOM.select({ref:"tiet_bat_dau",className:"form-control input-sm"},React.DOM.option({value:"1"},"1 (6h30)"),React.DOM.option({value:"2"},"2 (7h20)"),React.DOM.option({value:"3"},"3 (8h10)"),React.DOM.option({value:"4"},"4 (9h05)"),React.DOM.option({value:"5"},"5 (9h55)"),React.DOM.option({value:"6"},"6 (10h45)"),React.DOM.option({value:"7"},"7 (12h30)"),React.DOM.option({value:"8"},"8 (13h20)"),React.DOM.option({value:"9"},"9 (14h10)"),React.DOM.option({value:"10"},"10 (15h05)"),React.DOM.option({value:"11"},"11 (15h55)"),React.DOM.option({value:"12"},"12 (16h45)"),React.DOM.option({value:"13"},"13 (18h00)"),React.DOM.option({value:"14"},"14 (18h50)"),React.DOM.option({value:"15"},"15 (19h40)"),React.DOM.option({value:"16"},"16 (20h30)"))),React.DOM.td(null,React.DOM.input({type:"text",ref:"so_tiet",placeholder:"Số tiết dạy",className:"form-control input-sm"})),React.DOM.td(null,React.DOM.input({type:"text",placeholder:"Phòng",ref:"phong",className:"form-control input-sm"})),React.DOM.td(null,React.DOM.select({ref:"ltype",className:"form-control input-sm"},React.DOM.option({value:"lythuyet"},"Lý thuyết"),React.DOM.option({value:"thuchanh"},"Thực hành"),React.DOM.option({value:"tuhoc"},"Tự học"),React.DOM.option({value:"baitap"},"Bài tập"))),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-success curl-top-left",onClick:this.onCancelAdd},"Hủy"),React.DOM.button({className:"btn btn-sm btn-success curl-top-left",onClick:this.onSubmitAdd},"Cập nhật"))))),React.DOM.hr(null),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.th(null,"Stt"),React.DOM.th(null,"Thời gian"),React.DOM.th(null,"Tiết bắt đầu"),React.DOM.th(null,"Số tiết"),React.DOM.th(null,"Phòng"),React.DOM.th(null,"Loại"),React.DOM.th(null,"Trạng thái")),React.DOM.tbody(null,e)))):void 0}}),Row2=React.createClass({displayName:"Row2",getInitialState:function(){return{edit:0}},onClickEdit:function(){this.setState({edit:1})},handleCancelEdit:function(){this.setState({edit:0})},handleUpdate:function(){if(1==this.state.edit){var t=this.refs.tiet_bat_dau.getDOMNode().value,e=this.refs.thoi_gian.getDOMNode().value,a=this.refs.phong.getDOMNode().value,n=this.refs.so_tiet.getDOMNode().value,o=this.refs.ltype.getDOMNode().value,i={id:this.props.data.id,tiet_bat_dau:t,thoi_gian:e,phong:a,so_tiet:n,ltype:o};this.setState({edit:0}),this.props.onUpdate(i)}},componentDidUpdate:function(){1==this.state.edit&&(this.refs.thoi_gian.getDOMNode().value=this.props.data.thoi_gian,this.refs.tiet_bat_dau.getDOMNode().value=this.props.data.tiet_bat_dau,this.refs.so_tiet.getDOMNode().value=this.props.data.so_tiet,this.refs.phong.getDOMNode().value=this.props.data.phong,this.refs.ltype.getDOMNode().value=this.props.data.ltype,$(".input-append.date").datepicker({format:"dd/mm/yyyy",startDate:"11/8/2014",todayBtn:"linked",language:"vi",autoClose:!0,todayHighlight:!0}))},onRemove:function(){confirm("Đồng ý")&&this.props.onRemove(this.props.data)},onRestore:function(){confirm("Đồng ý")&&this.props.onRestore(this.props.data)},render:function(){return 0===this.state.edit?React.DOM.tr(null,React.DOM.td(null,this.props.data.id),React.DOM.td(null,this.props.data.thoi_gian),React.DOM.td(null,this.props.data.tiet_bat_dau),React.DOM.td(null,this.props.data.so_tiet),React.DOM.td(null,this.props.data.phong),React.DOM.td(null,this.props.data.type_status),React.DOM.td(null,this.props.data.alias_status),React.DOM.td(null,React.DOM.button({className:"btn btn-sm btn-success curl-top-left",onClick:this.onClickEdit,style:{display:this.props.data.can_edit===!1?"none":""}},"Sửa"),React.DOM.button({className:"btn btn-sm btn-danger curl-top-left",onClick:this.onRemove,style:{display:this.props.data.can_remove===!1?"none":""}},"Xóa"),React.DOM.button({className:"btn btn-sm btn-info curl-top-left",onClick:this.onRestore,style:{display:this.props.data.can_restore===!1?"none":""}},"Phục hồi"))):React.DOM.tr(null,React.DOM.td(null,this.props.data.id),React.DOM.td(null,React.DOM.div({className:"input-append date"},React.DOM.input({ref:"thoi_gian",type:"text",className:"span2"}),React.DOM.span({className:"add-on"},React.DOM.i({className:"icon-th"})))),React.DOM.td(null,React.DOM.select({ref:"tiet_bat_dau",className:"form-control input-sm"},React.DOM.option({value:"1"},"1 (6h30)"),React.DOM.option({value:"2"},"2 (7h20)"),React.DOM.option({value:"3"},"3 (8h10)"),React.DOM.option({value:"4"},"4 (9h05)"),React.DOM.option({value:"5"},"5 (9h55)"),React.DOM.option({value:"6"},"6 (10h45)"),React.DOM.option({value:"7"},"7 (12h30)"),React.DOM.option({value:"8"},"8 (13h20)"),React.DOM.option({value:"9"},"9 (14h10)"),React.DOM.option({value:"10"},"10 (15h05)"),React.DOM.option({value:"11"},"11 (15h55)"),React.DOM.option({value:"12"},"12 (16h45)"),React.DOM.option({value:"13"},"13 (18h00)"),React.DOM.option({value:"14"},"14 (18h50)"),React.DOM.option({value:"15"},"15 (19h40)"),React.DOM.option({value:"16"},"16 (20h30)"))),React.DOM.td(null,React.DOM.input({type:"text",ref:"so_tiet",className:"form-control input-sm"})),React.DOM.td(null,React.DOM.input({type:"text",ref:"phong",className:"form-control input-sm"})),React.DOM.td(null,React.DOM.select({ref:"ltype",className:"form-control input-sm"},React.DOM.option({value:"lythuyet"},"Lý thuyết"),React.DOM.option({value:"thuchanh"},"Thực hành"),React.DOM.option({value:"tuhoc"},"Tự học"),React.DOM.option({value:"baitap"},"Bài tập"))),React.DOM.td(null,this.props.data.alias_status),React.DOM.td(null,React.DOM.input({onClick:this.handleCancelEdit,className:"btn btn-sm",type:"submit",value:"Cancel"}),React.DOM.input({onClick:this.handleUpdate,className:"btn btn-sm btn-primary",type:"submit",value:"Update"})))}});