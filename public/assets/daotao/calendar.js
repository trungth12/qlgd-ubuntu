var DaotaoCalendar=React.createClass({displayName:"DaotaoCalendar",getInitialState:function(){return{data:[]}},loadData:function(){$.ajax({url:"/daotao/lops",success:function(t){this.setState({data:t.t})}.bind(this)})},componentWillMount:function(){this.loadData()},componentDidUpdate:function(){var t=this;$("#timlopcalendar").select2({data:t.state.data})},onSearch:function(){var t=$("#timlopcalendar").val();React.unmountAndReleaseReactRootNode(document.getElementById("cc")),React.renderComponent(CalendarComponent({lop_id:t}),document.getElementById("cc"))},render:function(){return React.DOM.div(null,React.DOM.hr(null),React.DOM.input({type:"hidden",id:"timlopcalendar",placeholder:"Lớp môn học",style:{width:"500px"},className:"input-xlarge"}),React.DOM.button({className:"btn btn-success",onClick:this.onSearch},"Tìm lớp"),React.DOM.hr(null),React.DOM.div({id:"cc"}))}}),tdata={tuans:[23,24,25,30,31,32,33],headers:[23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38]},CalendarComponent=React.createClass({displayName:"CalendarComponent",getInitialState:function(){return{tuans:[],headers:[],calendars:[],giang_viens:[],phongs:[]}},loadData:function(){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars",success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},componentWillMount:function(){this.loadData()},handleDelete:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/delete",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleGenerate:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/generate",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleRestore:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/restore",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleAdd:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/add",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},handleDestroy:function(t){$.ajax({url:"/daotao/lop_mon_hocs/"+this.props.lop_id+"/calendars/destroy",type:"POST",data:t,success:function(t){this.setState({tuans:t.tuans,headers:t.headers,calendars:t.calendars,giang_viens:t.giang_viens,phongs:t.phongs})}.bind(this)})},componentDidUpdate:function(){React.unmountAndReleaseReactRootNode(document.getElementById("tc")),React.renderComponent(TaoCalendar({giang_viens:this.state.giang_viens,phongs:this.state.phongs,onAdd:this.handleAdd}),document.getElementById("tc"))},render:function(){var t=this,a=this.state.headers.map(function(t){return React.DOM.td(null,t)}),e=this.state.headers.map(function(a){return t.state.tuans.indexOf(a)>=0?React.DOM.td({className:"success"},"H"):React.DOM.td(null,"_")}),n=this.state.calendars.map(function(a){return DaotaoCalendarRow({onDestroy:t.handleDestroy,onDelete:t.handleDelete,onGenerate:t.handleGenerate,onRestore:t.handleRestore,data:a})});return React.DOM.div(null,React.DOM.h4(null,"Tạo thời khóa biểu"),React.DOM.div({id:"tc"}),React.DOM.hr(null),React.DOM.h4(null,"Thời khóa biểu"),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table tabled-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần học bắt đầu"),React.DOM.td(null,"Số tuần"),React.DOM.td(null,"Thứ"),React.DOM.td(null,"Tiết bắt đầu"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Giảng viên"),React.DOM.td(null,"Trạng thái"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,n))),React.DOM.hr(null),React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table tabled-bordered"},React.DOM.thead(null,React.DOM.tr({className:"danger"},a)),React.DOM.tbody(null,React.DOM.tr(null,e)))))}}),TaoCalendar=React.createClass({displayName:"TaoCalendar",range:function(t,a){for(var e=[],n=t;a>=n;n++)e.push(n);return e},onAdd:function(){var t=this.refs.tuan_hoc_bat_dau.getDOMNode().value,a=this.refs.so_tuan.getDOMNode().value,e=this.refs.thu.getDOMNode().value,n=this.refs.tiet_bat_dau.getDOMNode().value,s=this.refs.so_tiet.getDOMNode().value,o=this.refs.phong.getDOMNode().value,l=this.refs.giang_vien.getDOMNode().value,c={tuan_hoc_bat_dau:t,so_tuan:a,thu:e,tiet_bat_dau:n,so_tiet:s,phong:o,giang_vien_id:l};this.props.onAdd(c)},render:function(){var t=this.range(1,20),a=this.range(1,20),e=this.range(1,5),n=t.map(function(t){return React.DOM.option({value:t},t)}),s=a.map(function(t){return React.DOM.option({value:t},t)}),o=e.map(function(t){return React.DOM.option({value:t},t)}),l=this.props.giang_viens.map(function(t){return React.DOM.option({value:t.id},t.text)}),c=this.props.phongs.map(function(t){return React.DOM.option({value:t.id},t.text)});return React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table tabled-bordered"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần học bắt đầu"),React.DOM.td(null,"Số tuần"),React.DOM.td(null,"Thứ"),React.DOM.td(null,"Tiết bắt đầu"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Giảng viên"))),React.DOM.tbody(null,React.DOM.tr(null,React.DOM.td(null,React.DOM.select({ref:"tuan_hoc_bat_dau",className:"form-control input-sm"},n)),React.DOM.td(null,React.DOM.select({ref:"so_tuan",className:"form-control input-sm"},s)),React.DOM.td(null,React.DOM.select({ref:"thu",className:"form-control input-sm"},React.DOM.option({value:"2"},"Thứ hai"),React.DOM.option({value:"3"},"Thứ ba"),React.DOM.option({value:"4"},"Thứ tư"),React.DOM.option({value:"5"},"Thứ năm"),React.DOM.option({value:"6"},"Thứ sáu"),React.DOM.option({value:"7"},"Thứ bảy"),React.DOM.option({value:"8"},"Chủ nhật"))),React.DOM.td(null,React.DOM.select({ref:"tiet_bat_dau",className:"form-control input-sm"},React.DOM.option({value:"1"},"1 (7h00)"),React.DOM.option({value:"2"},"2 (7h55)"),React.DOM.option({value:"3"},"3 (8h55)"),React.DOM.option({value:"4"},"4 (9h50)"),React.DOM.option({value:"5"},"5 (10h45)"),React.DOM.option({value:"6"},"6 (13h00)"),React.DOM.option({value:"7"},"7 (13h55)"),React.DOM.option({value:"8"},"8 (14h55)"),React.DOM.option({value:"9"},"9 (15h50)"),React.DOM.option({value:"10"},"10 (16h45)"),React.DOM.option({value:"11"},"11 (15h55)"),React.DOM.option({value:"12"},"12 (16h45)"),React.DOM.option({value:"13"},"13 (18h00)"),React.DOM.option({value:"14"},"14 (18h50)"),React.DOM.option({value:"15"},"15 (19h40)"),React.DOM.option({value:"16"},"16 (20h30)"))),React.DOM.td(null,React.DOM.select({ref:"so_tiet",className:"form-control input-sm"},o)),React.DOM.td(null,React.DOM.select({ref:"phong",className:"form-control input-sm"},c)),React.DOM.td(null,React.DOM.select({ref:"giang_vien",className:"form-control input-sm"},l))))),React.DOM.button({onClick:this.onAdd,className:"btn btn-sm btn-success"},"Thêm"))}}),DaotaoCalendarRow=React.createClass({displayName:"DaotaoCalendarRow",onDelete:function(){this.props.onDelete(this.props.data)},onGenerate:function(){this.props.onGenerate(this.props.data)},onRestore:function(){this.props.onRestore(this.props.data)},onDestroy:function(){this.props.onDestroy(this.props.data)},render:function(){return React.DOM.tr(null,React.DOM.td(null,this.props.data.tuan_hoc_bat_dau),React.DOM.td(null,this.props.data.so_tuan),React.DOM.td(null,this.props.data.thu),React.DOM.td(null,this.props.data.tiet_bat_dau),React.DOM.td(null,this.props.data.so_tiet),React.DOM.td(null,this.props.data.phong),React.DOM.td(null,this.props.data.giang_vien),React.DOM.td(null,this.props.data.state),React.DOM.td(null,React.DOM.button({style:{display:this.props.data.can_generate===!0?"":"none"},className:"btn btn-sm btn-primary",onClick:this.onGenerate},"Duyệt thực hiện"),React.DOM.button({style:{display:this.props.data.can_remove===!0?"":"none"},className:"btn btn-sm btn-warning",onClick:this.onDelete},"Xóa"),React.DOM.button({style:{display:this.props.data.can_restore===!0?"":"none"},className:"btn btn-sm btn-default",onClick:this.onRestore},"Phục hồi"),React.DOM.button({className:"btn btn-sm btn-danger",onClick:this.onDestroy},"Xóa vĩnh viễn")))}});
