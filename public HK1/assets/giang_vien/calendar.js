var Calendar=React.createClass({displayName:"Calendar",getInitialState:function(){return{data:[]}},loadData:function(){$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days",success:function(t){this.setState({data:t})}.bind(this)})},componentWillMount:function(){this.loadData()},updateLich:function(){null!=ENV.lich_id&&(React.unmountAndReleaseReactRootNode(document.getElementById("main")),React.renderComponent(Lich({lich:ENV.lich_id,lop:ENV.lop_id}),document.getElementById("main")))},handleNghiday:function(t){t.lop_id=this.props.lop,$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/nghiday",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),this.updateLich()}.bind(this)})},handleUnNghiday:function(t){t.lop_id=this.props.lop,$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/unnghiday",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),this.updateLich()}.bind(this)})},handleUncomplete:function(t){t.lop_id=this.props.lop,$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/uncomplete",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),React.unmountAndReleaseReactRootNode(document.getElementById("bosung")),React.renderComponent(Bosung({giang_vien:this.props.giang_vien,lop:this.props.lop}),document.getElementById("bosung")),this.updateLich()}.bind(this)})},handleRemove:function(t){t.lop_id=this.props.lop,$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/remove",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),React.unmountAndReleaseReactRootNode(document.getElementById("bosung")),React.renderComponent(Bosung({giang_vien:this.props.giang_vien,lop:this.props.lop}),document.getElementById("bosung")),this.updateLich()}.bind(this)})},handleRestore:function(t){t.giang_vien=this.props.giang_vien,t.lop_id=this.props.lop,$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/restore",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),React.unmountAndReleaseReactRootNode(document.getElementById("bosung")),React.renderComponent(Bosung({giang_vien:this.props.giang_vien,lop:this.props.lop}),document.getElementById("bosung")),this.updateLich()}.bind(this)})},handleUpdate:function(t){t.giang_vien=this.props.giang_vien,t.lop_id=this.props.lop,$.ajax({url:"/teacher/lop/"+this.props.lop+"/lich_trinh_giang_days/update",type:"POST",data:t,success:function(t){this.setState({data:t,add:0}),this.updateLich()}.bind(this)})},render:function(){var t=this,a=this.state.data.map(function(a,e){return"Bổ sung"===a.alias_state?CalendarRowBosung({color:(e+1)%2===0?"danger":"default",key:"bosung-"+a.id,onRemove:t.handleRemove,onRestore:t.handleRestore,onUncomplete:t.handleUncomplete,data:a}):"Nghỉ dạy"===a.alias_state?CalendarRowNghiday({color:(e+1)%2===0?"danger":"default",key:"nghiday"+a.id,onRemove:t.handleRemove,onRestore:t.handleRestore,onUnNghiday:t.handleUnNghiday,data:a}):CalendarRow({color:(e+1)%2===0?"danger":"default",key:"normal"+a.id,onUpdate:t.handleUpdate,onRemove:t.handleRemove,onRestore:t.handleRestore,onComplete:t.handleComplete,onNghiday:t.handleNghiday,onUncomplete:t.handleUncomplete,data:a})});return React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered table-striped"},React.DOM.thead(null,React.DOM.tr({className:"success"},React.DOM.td(null,"Tuần"),React.DOM.td(null,"Thời gian"),React.DOM.td(null,"Tiết bắt đầu"),React.DOM.td(null,"Phòng"),React.DOM.td(null,"Số tiết"),React.DOM.td(null,"Loại"),React.DOM.td(null,"Giờ học"),React.DOM.td(null,"Trạng thái"),React.DOM.td(null,"Lí do nghỉ dạy"),React.DOM.td(null,"Thao tác"))),React.DOM.tbody(null,a)))}}),CalendarRowNghiday=React.createClass({displayName:"CalendarRowNghiday",getInitialState:function(){return{edit:0}},onUnNghiday:function(){this.props.onUnNghiday(this.props.data)},onRemove:function(){this.props.onRemove(this.props.data)},onRestore:function(){this.props.onRestore(this.props.data)},render:function(){var t={"font-weight":this.props.data.active===!0?"bold":""};return 0===this.state.edit?React.DOM.tr({style:t,className:this.props.color},React.DOM.td(null,this.props.data.tuan),React.DOM.td(null,React.DOM.a({href:"/lich/"+this.props.data.id},this.props.data.thoi_gian)),React.DOM.td(null,this.props.data.tiet_bat_dau),React.DOM.td(null,this.props.data.phong),React.DOM.td(null,this.props.data.so_tiet),React.DOM.td(null,this.props.data.type_status),React.DOM.td(null,this.props.data.alias_state),React.DOM.td(null,React.DOM.span({className:this.props.data.color_status},this.props.data.alias_status)),React.DOM.td(null,this.props.data.note),React.DOM.td(null,React.DOM.button({onClick:this.onUnNghiday,style:{display:this.props.data.can_unnghiday===!1?"none":""},className:"btn btn-sm btn-primary curl-top-left"},"Hủy đăng ký"),React.DOM.button({onClick:this.onRemove,style:{display:this.props.data.can_remove===!1?"none":""},className:"btn btn-sm btn-danger curl-top-left"},"Xóa"),React.DOM.button({onClick:this.onRestore,style:{display:this.props.data.can_restore===!1?"none":""},className:"btn btn-sm btn-default curl-top-left"},"Phục hồi"))):void 0}}),CalendarRowBosung=React.createClass({displayName:"CalendarRowBosung",onUncomplete:function(){this.props.onUncomplete(this.props.data)},onRestore:function(){this.props.onRestore(this.props.data)},onRemove:function(){this.props.onRemove(this.props.data)},render:function(){var t={"font-weight":this.props.data.active===!0?"bold":""};return React.DOM.tr({style:t,className:this.props.color},React.DOM.td(null,this.props.data.tuan),React.DOM.td(null,React.DOM.a({href:"/lich/"+this.props.data.id},this.props.data.thoi_gian)),React.DOM.td(null,this.props.data.tiet_bat_dau),React.DOM.td(null,this.props.data.phong),React.DOM.td(null,this.props.data.so_tiet),React.DOM.td(null,this.props.data.type_status),React.DOM.td(null,this.props.data.alias_state),React.DOM.td(null,React.DOM.span({className:this.props.data.color_status},this.props.data.alias_status)),React.DOM.td(null,this.props.data.note),React.DOM.td(null,React.DOM.button({onClick:this.onRemove,style:{display:this.props.data.can_remove===!1?"none":""},className:"btn btn-sm btn-danger curl-top-left"},"Xóa"),React.DOM.button({onClick:this.onRestore,style:{display:this.props.data.can_restore===!1?"none":""},className:"btn btn-sm btn-default curl-top-left"},"Phục hồi"),React.DOM.button({onClick:this.onUncomplete,style:{display:this.props.data.can_uncomplete===!1?"none":""},className:"btn btn-sm btn-primary curl-top-left"},"Hủy hoàn thành")))}}),CalendarRow=React.createClass({displayName:"CalendarRow",getInitialState:function(){return{edit:0}},onEdit:function(){this.setState({edit:1})},onCancelEdit:function(){this.setState({edit:0})},onUpdate:function(){var t=(this.refs.note.getDOMNode().value,this.refs.so_tiet.getDOMNode().value),a=this.refs.phong.getDOMNode().value,e=this.refs.ltype.getDOMNode().value,n={id:this.props.data.id,so_tiet:t,phong:a,ltype:e};this.setState({edit:0}),this.props.onUpdate(n)},onUncomplete:function(){this.props.onUncomplete(this.props.data)},onRestore:function(){this.props.onRestore(this.props.data)},onRemove:function(){this.props.onRemove(this.props.data)},onNghiday:function(){this.props.data.note=this.refs.note.getDOMNode().value,this.props.onNghiday(this.props.data)},componentDidUpdate:function(){this.refs.note.getDOMNode().value=this.props.data.note,1===this.state.edit&&(this.refs.so_tiet.getDOMNode().value=this.props.data.so_tiet,this.refs.phong.getDOMNode().value=this.props.data.phong,this.refs.ltype.getDOMNode().value=this.props.data.ltype)},render:function(){var t={"font-weight":this.props.data.active===!0?"bold":""};return 0===this.state.edit?React.DOM.tr({style:t,className:this.props.color},React.DOM.td(null,this.props.data.tuan),React.DOM.td(null,React.DOM.a({href:"/lich/"+this.props.data.id},this.props.data.thoi_gian)),React.DOM.td(null,this.props.data.tiet_bat_dau),React.DOM.td(null,this.props.data.phong),React.DOM.td(null,this.props.data.so_tiet),React.DOM.td(null,this.props.data.type_status),React.DOM.td(null,this.props.data.alias_state),React.DOM.td(null,React.DOM.span({className:this.props.data.color_status},this.props.data.alias_status)),React.DOM.td(null,React.DOM.input({type:"text",ref:"note",placeholder:"Lí do nghỉ dạy"})),React.DOM.td(null,React.DOM.button({onClick:this.onNghiday,style:{display:this.props.data.can_nghiday===!1?"none":""},className:"btn btn-sm btn-warning curl-top-left"},"Đăng ký nghỉ"),React.DOM.button({onClick:this.onEdit,style:{display:this.props.data.can_edit===!1?"none":""},className:"btn btn-sm btn-success curl-top-left"},"Sửa"),React.DOM.button({onClick:this.onRemove,style:{display:this.props.data.can_remove===!1?"none":""},className:"btn btn-sm btn-danger curl-top-left"},"Xóa"),React.DOM.button({onClick:this.onRestore,style:{display:this.props.data.can_restore===!1?"none":""},className:"btn btn-sm btn-default curl-top-left"},"Phục hồi"),React.DOM.button({onClick:this.onUncomplete,style:{display:this.props.data.can_uncomplete===!1?"none":""},className:"btn btn-sm btn-primary curl-top-left"},"Hủy hoàn thành"))):React.DOM.tr({style:t,className:this.props.color},React.DOM.td(null,this.props.data.tuan),React.DOM.td(null,React.DOM.a({href:"/lich/"+this.props.data.id},this.props.data.thoi_gian)),React.DOM.td(null,this.props.data.tiet_bat_dau),React.DOM.td(null,React.DOM.input({type:"text",ref:"phong",className:"form-control input-sm"})),React.DOM.td(null,React.DOM.input({type:"text",ref:"so_tiet",className:"form-control input-sm"})),React.DOM.td(null,React.DOM.select({ref:"ltype",className:"form-control input-sm"},React.DOM.option({value:"lythuyet"},"Lý thuyết"),React.DOM.option({value:"thuchanh"},"Thực hành"),React.DOM.option({value:"tuhoc"},"Tự học"),React.DOM.option({value:"baitap"},"Bài tập"))),React.DOM.td(null,this.props.data.alias_state),React.DOM.td(null,React.DOM.span({className:this.props.data.color_status},this.props.data.alias_status)),React.DOM.td(null,React.DOM.input({type:"text",ref:"note",placeholder:"Ghi chú buổi học"})),React.DOM.td(null,React.DOM.button({onClick:this.onCancelEdit,className:"btn btn-sm btn-warning curl-top-left"},"Hủy"),React.DOM.button({onClick:this.onUpdate,className:"btn btn-sm btn-success curl-top-left"},"Cập nhật")))}});