var Cell=React.createClass({displayName:"Cell",handleInput:function(){this.props.onInput1(this.props.data.index)},handleBlur:function(){var e=this.refs.grade.getDOMNode().value,t={index:this.props.data.index,assignment_id:this.props.data.assignment_id,sinh_vien_id:this.props.data.sinh_vien_id,grade:e};this.props.onEnter(t)},handleKey:function(e){if(1==this.props.data.edit){var t=this.refs.grade.getDOMNode().value,a={index:this.props.data.index,assignment_id:this.props.data.assignment_id,sinh_vien_id:this.props.data.sinh_vien_id,grade:t};e.shiftKey&&9==e.keyCode?(e.preventDefault(),this.props.onKeyPress(a,"left")):38==e.keyCode?(e.preventDefault(),this.props.onKeyPress(a,"up")):9!=e.keyCode||e.shiftKey?40==e.keyCode?(e.preventDefault(),this.props.onKeyPress(a,"down")):(13==e.keyCode||27==e.keyCode)&&(e.preventDefault(),this.props.onEnter(a)):(e.preventDefault(),this.props.onKeyPress(a,"right"))}},componentDidUpdate:function(){1===this.props.data.edit&&($("#mi").focus(),$("#mi").val(this.props.data.grade))},render:function(){return 0===this.props.data.edit?React.DOM.div({ref:"t",onClick:this.handleInput},this.props.data.grade," / ",this.props.data.assignment_points):1===this.props.data.edit?React.DOM.span(null,React.DOM.input({id:"mi",ref:"grade",onKeyDown:this.handleKey,onFocus:this.handleInput,onBlur:this.handleBlur,type:"text"})," / ",this.props.data.assignment_points):void 0}}),Row=React.createClass({displayName:"Row",render:function(){var e=this,t=this.props.data.map(function(t){return React.DOM.td(null,Cell({key:"rowcell"+t.sinh_vien_id.toString()+"-"+t.assignment_id.toString(),onKeyPress:e.props.handleKeyPress,data:t,onBlur1:e.props.handleBlur,onChange1:e.props.handleChange,onInput1:e.props.handleInput,onEnter:e.props.handleEnter}))});return React.DOM.tr(null,React.DOM.td(null,this.props.name),t)}}),RowGroup=React.createClass({displayName:"RowGroup",render:function(){var e=this.props.data.map(function(e){return React.DOM.td(null,e.diem_trung_binh)});return React.DOM.tr(null,React.DOM.td(null,this.props.name),e,React.DOM.td(null,this.props.diem_qua_trinh))}}),GRADE={data:[[{sinh_vien_id:0,assignment_id:0,grade:0},{sinh_vien_id:0,assignment_id:1,grade:1}],[{sinh_vien_id:1,assignment_id:0,grade:0},{sinh_vien_id:1,assignment_id:1,grade:1}]]},Grade=React.createClass({displayName:"Grade",getInitialState:function(){return{names:[],data:[],group_names:[],group_data:[],active:-1,active2:-1}},loadSubmissions:function(){$.ajax({url:"/teacher/lop/"+this.props.lop+"/submissions.json",success:function(e){this.setState({names:e.names,group_names:e.group_names,data:e.results,group_data:e.group_results,active:-1})}.bind(this)})},getStatus:function(e){return this.state.active===e.index?1:0},saveToServer:function(e,t){var a={assignment_id:e.assignment_id,sinh_vien_id:e.sinh_vien_id,grade:e.grade};return $.ajax({url:"/teacher/lop/"+this.props.lop+"/submissions",type:"POST",data:a,success:function(e){this.setState({names:e.names,data:e.results,group_data:e.group_results,group_names:e.group_names,active:t}),React.unmountAndReleaseReactRootNode(document.getElementById("assignment")),React.renderComponent(Assignments({lop:this.props.lop}),document.getElementById("assignment"))}.bind(this)}),!1},handleEnter:function(e){this.saveToServer(e,-1)},handleInput:function(e){this.setState({active:e})},handleBlur:function(){this.setState({active:-1})},handleKeyPress:function(e,t){"left"==t?this.saveToServer(e,e.index-1):"up"==t?this.saveToServer(e,e.index-this.state.names.length):"down"==t?this.saveToServer(e,e.index+this.state.names.length):"right"==t&&this.saveToServer(e,e.index+1)},componentWillMount:function(){this.loadSubmissions()},render:function(){var e=this,t=React.DOM.th(null,"Họ và tên"),a=(React.DOM.th(null,"Điểm quá trình"),this.state.names.map(function(e){return React.DOM.th(null,React.DOM.div(null,React.DOM.strong(null,e.name)),React.DOM.ul(null,React.DOM.li(null,"- Thang điểm ",e.points),React.DOM.li(null,"- Nhóm ",e.group_name,", ",e.group_weight," % ")))})),n=this.state.group_names.map(function(e){return React.DOM.th(null,e.name," - ",e.weight)}),s=this.state.data.map(function(t){return t.assignments.map(function(t){return t.edit=e.getStatus(t),t}),t}),i=s.map(function(t){return Row({key:"row"+t.id,name:t.name,handleKeyPress:e.handleKeyPress,handleEnter:e.handleEnter,handleInput:e.handleInput,handleBlur:e.handleBlur,data:t.assignments})}),r=this.state.group_data.map(function(e){return RowGroup({key:"rowgroup"+e.id,name:e.name,diem_qua_trinh:e.diem_qua_trinh,data:e.assignment_groups})});return React.DOM.div({className:"panel-group",id:"accordion-grade"},React.DOM.div({className:"panel panel-default"},React.DOM.div({className:"panel-heading"},React.DOM.h4({className:"panel-title"},React.DOM.a({"data-toggle":"collapse","data-parent":"#accordion-grade",href:"#collapseOne-grade"}," Điểm chi tiết "))),React.DOM.div({id:"collapseOne-grade",className:"panel-collapse collapse in"},React.DOM.div({className:"panel-body"},React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr(null,t,a)),React.DOM.tbody(null,i)))))),React.DOM.div({className:"panel panel-default"},React.DOM.div({className:"panel-heading"},React.DOM.h4({className:"panel-title"},React.DOM.a({"data-toggle":"collapse","data-parent":"#accordion-grade",href:"#collapseTwo-grade"}," Điểm tổng hợp "))),React.DOM.div({id:"collapseTwo-grade",className:"panel-collapse collapse"},React.DOM.div({className:"panel-body"},React.DOM.div({className:"table-responsive"},React.DOM.table({className:"table table-bordered"},React.DOM.thead(null,React.DOM.tr(null,React.DOM.th(null,"Họ và tên"),n,React.DOM.th(null,"Điểm quá trình"))),React.DOM.tbody(null,r)))))))}});